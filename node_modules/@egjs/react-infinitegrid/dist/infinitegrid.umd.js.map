{"version":3,"file":"infinitegrid.umd.js","sources":["../src/consts.ts","../src/utils.ts","../src/InfiniteGrid.tsx","../src/grids/MasonryInfiniteGrid.tsx","../src/grids/JustifiedInfiniteGrid.tsx","../src/grids/FrameInfiniteGrid.tsx","../src/grids/PackingInfiniteGrid.tsx"],"sourcesContent":["\nexport const REACT_INFINITEGRID_EVENT_MAP = {\n  \"onContentError\": \"contentError\",\n  \"onRenderComplete\": \"renderComplete\",\n  \"onRequestAppend\": \"requestAppend\",\n  \"onRequestPrepend\": \"requestPrepend\",\n  \"onChangeScroll\": \"changeScroll\",\n} as const;\n\nexport const REACT_INFINITEGRID_EVENTS: string[] = [];\n\nfor (const name in REACT_INFINITEGRID_EVENT_MAP) {\n  REACT_INFINITEGRID_EVENTS.push(name);\n}\n\nexport const REACT_INFINITEGRID_PROPS = [\n  \"tag\",\n  \"placeholder\",\n  \"status\",\n  \"useFirstRender\",\n  \"loading\",\n  \"itemBy\",\n  \"groupBy\",\n  ...REACT_INFINITEGRID_EVENTS,\n];\n","export function isFunction(val: any): val is Function {\n  return typeof val === \"function\";\n}\n","/**\n * egjs-infinitegrid\n * Copyright (c) 2021-present NAVER Corp.\n * MIT license\n */\nimport * as React from \"react\";\nimport VanillaInfiniteGrid, {\n  InfiniteGridOptions, InfiniteGridFunction,\n  Renderer,\n  InfiniteGridItemInfo, ITEM_TYPE,\n  InfiniteGridMethods,\n  withInfiniteGridMethods,\n  getRenderingItems,\n  mountRenderingItems,\n} from \"@egjs/infinitegrid\";\nimport { ReactInfiniteGridProps } from \"./types\";\nimport { REACT_INFINITEGRID_PROPS, REACT_INFINITEGRID_EVENT_MAP } from \"./consts\";\nimport { isFunction } from \"./utils\";\n\nexport abstract class InfiniteGrid<T extends InfiniteGridOptions>\n  extends React.Component<T & ReactInfiniteGridProps & { [key: string]: any }> {\n  public static GridClass: InfiniteGridFunction;\n  @withInfiniteGridMethods\n  private _grid!: VanillaInfiniteGrid;\n  private _wrapperRef = React.createRef<HTMLDivElement>();\n  private _containerRef = React.createRef<HTMLDivElement>();\n  private _renderer!: Renderer;\n\n  public render() {\n    const attributes: { [key: string]: any } = {};\n    const props = this.props;\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const defaultOptions = GridClass.defaultOptions;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const Tag = props.tag as any || \"div\";\n\n    for (const name in props) {\n      if (name in defaultOptions || REACT_INFINITEGRID_PROPS.indexOf(name as any) > -1) {\n        continue;\n      }\n      attributes[name] = props[name];\n    }\n\n    return <Tag ref={this._wrapperRef} {...attributes}>\n      {this._renderContainer()}\n    </Tag>;\n  }\n  public componentDidMount() {\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const defaultOptions = GridClass.defaultOptions;\n    const options: Partial<InfiniteGridOptions> = {};\n    const props = this.props;\n    const containerElement = this._containerRef.current;\n\n    for (const name in defaultOptions) {\n      if (name in props) {\n        (options as any)[name] = (props as any)[name];\n      }\n    }\n    if (containerElement) {\n      options.container = containerElement;\n    }\n    this._renderer = new Renderer();\n    options.renderer = this._renderer;\n    const grid = new GridClass(this._wrapperRef.current!, options);\n\n    for (const eventName in REACT_INFINITEGRID_EVENT_MAP) {\n      const nativeEventName = (REACT_INFINITEGRID_EVENT_MAP as any)[eventName];\n\n      grid.on(nativeEventName, (e: any) => {\n        const callback = this.props[eventName];\n\n        callback && callback(e);\n      });\n    }\n\n    this._grid = grid;\n    this._renderer.on(\"update\", () => {\n      this.setState({});\n    });\n\n    mountRenderingItems(this._getItemInfos(), {\n      grid,\n      useFirstRender: props.useFirstRender,\n      useLoading: props.loading,\n      usePlaceholder: props.placeholder,\n      horizontal: props.horizontal,\n      status: props.status,\n    });\n    this._renderer.updated();\n  }\n\n  public componentDidUpdate() {\n    const GridClass = (this.constructor as typeof InfiniteGrid).GridClass;\n    const propertyTypes = GridClass.propertyTypes;\n    const props = this.props;\n    const grid = this._grid;\n\n    for (const name in propertyTypes) {\n      if (name in props) {\n        (grid as any)[name] = (props as any)[name];\n      }\n    }\n    this._renderer.updated();\n  }\n\n  public componentWillUnmount() {\n    this._grid.destroy();\n  }\n\n  private _getItemInfos(): InfiniteGridItemInfo[] {\n    const props = this.props;\n    const children = React.Children.toArray(props.children) as React.ReactElement[];\n    const attributePrefix = props.attributePrefix || VanillaInfiniteGrid.defaultOptions.attributePrefix;\n    const itemBy = props.itemBy || ((item: React.ReactElement) => item.key);\n    const groupBy = props.groupBy || ((item: React.ReactElement) => item.props[`${attributePrefix}groupkey`]);\n\n    return children.map((child, i) => {\n      return {\n        groupKey: groupBy(child, i),\n        key: itemBy(child, i),\n        data: {\n          jsx: child,\n        },\n      };\n    });\n  }\n  private _renderContainer() {\n    const props = this.props;\n    const visibleChildren = this._getVisibleChildren();\n    const container = props.container;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const ContainerTag = props.containerTag as any || \"div\";\n\n    if (container === true) {\n      return <ContainerTag ref={this._containerRef}>\n        {visibleChildren}\n      </ContainerTag>;\n    } else {\n      return visibleChildren;\n    }\n  }\n  private _getVisibleChildren() {\n    const props = this.props;\n    const placeholder = props.placeholder;\n    const loading = props.loading;\n    const visibleItems = getRenderingItems(this._getItemInfos(), {\n      grid: this._grid,\n      status: props.status,\n      horizontal: props.horizontal,\n      useFirstRender: props.useFirstRender,\n      useLoading: props.loading,\n      usePlaceholder: props.placeholder,\n    });\n\n    return visibleItems.map((item) => {\n      if (item.type === ITEM_TYPE.VIRTUAL) {\n        return React.cloneElement(isFunction(placeholder) ? placeholder(item) : placeholder, { key: item.key });\n      } else if (item.type === ITEM_TYPE.LOADING) {\n        return React.cloneElement(isFunction(loading) ? loading(item) : loading, { key: item.key });\n      } else {\n        return item.data.jsx;\n      }\n    });\n  }\n}\nexport interface InfiniteGrid<T extends InfiniteGridOptions> extends InfiniteGridMethods<InfiniteGrid<T>> { }\n","import {\n  MasonryInfiniteGrid as VanillaMasonryInfiniteGrid,\n  MasonryInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class MasonryInfiniteGrid extends InfiniteGrid<MasonryInfiniteGridOptions> {\n  public static GridClass = VanillaMasonryInfiniteGrid;\n}\n","import {\n  JustifiedInfiniteGrid as VanillaJustifiedInfiniteGrid,\n  JustifiedInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class JustifiedInfiniteGrid extends InfiniteGrid<JustifiedInfiniteGridOptions> {\n  public static GridClass = VanillaJustifiedInfiniteGrid;\n}\n","import {\n  FrameInfiniteGrid as VanillaFrameInfiniteGrid,\n  FrameInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class FrameInfiniteGrid extends InfiniteGrid<FrameInfiniteGridOptions> {\n  public static GridClass = VanillaFrameInfiniteGrid;\n}\n","import {\n  PackingInfiniteGrid as VanillaPackingInfiniteGrid,\n  PackingInfiniteGridOptions,\n} from \"@egjs/infinitegrid\";\nimport { InfiniteGrid } from \"../InfiniteGrid\";\n\nexport class PackingInfiniteGrid extends InfiniteGrid<PackingInfiniteGridOptions> {\n  public static GridClass = VanillaPackingInfiniteGrid;\n}\n"],"names":["REACT_INFINITEGRID_EVENT_MAP","REACT_INFINITEGRID_EVENTS","name","push","REACT_INFINITEGRID_PROPS","isFunction","val","__extends","_this","React","attributes","props","GridClass","constructor","defaultOptions","Tag","tag","indexOf","ref","_wrapperRef","_renderContainer","options","containerElement","_containerRef","current","container","_renderer","Renderer","renderer","grid","eventName","nativeEventName","on","e","callback","_grid","setState","mountRenderingItems","_getItemInfos","useFirstRender","useLoading","loading","usePlaceholder","placeholder","horizontal","status","updated","propertyTypes","destroy","children","toArray","attributePrefix","VanillaInfiniteGrid","itemBy","item","key","groupBy","map","child","i","groupKey","data","jsx","visibleChildren","_getVisibleChildren","ContainerTag","containerTag","visibleItems","getRenderingItems","type","ITEM_TYPE","VIRTUAL","LOADING","__decorate","withInfiniteGridMethods","MasonryInfiniteGrid","VanillaMasonryInfiniteGrid","InfiniteGrid","JustifiedInfiniteGrid","VanillaJustifiedInfiniteGrid","FrameInfiniteGrid","VanillaFrameInfiniteGrid","PackingInfiniteGrid","VanillaPackingInfiniteGrid"],"mappings":"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"}